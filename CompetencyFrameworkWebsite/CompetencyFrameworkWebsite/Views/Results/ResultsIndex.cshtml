@model CompetencyFrameworkWebsite.Models.ResultsModel
@using CompetencyFrameworkWebsite.Controllers
@using Microsoft.Ajax.Utilities
@using System.Configuration;
@using System.Data.SqlClient;


@{

    ViewBag.Title = "Results";
}

@using (Html.BeginForm("SaveUserData", "Results",FormMethod.Post))
{
    <div style="padding: 10px">

        @{
           
            foreach (var topic in Model.TopicsName)
            {
            
                <table style="border-collapse:collapse;width:100%">
                    <tr>
                        <th style="border:solid thin;"></th>
                        <td style="border:solid thin; align-content:center">@topic</td>
                        <th style="border:solid thin"></th>
                        <th style="border:solid thin"></th>
                    </tr>
                 
                    @foreach (var result in Model.Results.Where(x => x.TopicName == @topic))
                    {
                        <tr style="border:solid thin">



                            <td style="border:solid thin; width:100px">@result.AreaName</td>
                            <td style="border:solid thin">@result.CompetencyName</td>
                            <td style="border:solid thin" hidden><input type="text" hidden name="competencyID" value="@result.CompetencyID"></td>
                            <td style="border:solid thin; width:100px">@result.RatingName</td>
                            <td style="border:solid thin" hidden><input type="text" id="rating" class="ratingID"   value="@result.RatingID"></td>
                           
                            <td >
                               
                                    @if (result.RatingTypeID.Equals(1))
                                    {
                                        <select name="userRating"  id="userRatingColour" onclick="changeColour()" class="colourAbove">
                                         @foreach (var UserRating in Model.RatingID.GetRange(0, 6))
                                         {


                                         <option value=@UserRating.RatingID class="colour">@UserRating.RatingName</option>
                                           

                                         }
                                        </select>

                                    }

                                    else
                                    {
                                            <select name="userRating"  >
                                            @foreach (var UserRating in Model.RatingID.GetRange(6, 6))
                                            {

                                        <option value = @UserRating.RatingID > @UserRating.RatingName </option >


                                            }
                                     </select >

                                    }

                                </td >
                          
                        </tr >
                        }
            
                </table>
                <br />


                <script src= "http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript" ></script>


                <script type="text/javascript">

                    document.getElementById("userRatingColour").selectedIndex = function ()
                    { changeColour() };
                    function changeColour(){

                        // $(document).on("click", "userRatingColour", function () {
                        //   alert("my life")
                        // });
                        //var y = document.getElementById('ratingID').value;
                        var x = document.getElementById('userRatingColour').selectedIndex;

                        //var selected = $("#userRatingColour").val();
                        alert(x);
                        //var x = '';
                        //var y = document.getElementById('rating').value;
                        //$("userRatingColour").find('option.selected').each(function () 
                        //$("option").each(function () {
                        //    //(this).val().style.color = "blue"
                          
                        //});
                       // $("userRatingColour").each(function () {

                            //    if (parseInt($(this).val()) != 0) {

                            //    x = $(this).val();
                            //}

                            //  if (x == 0 || x == 1 || x == 5 && y == '6') {
                            //document.getElementById('userRatingColour').style.color = 'green'
                            //document.getElementsById('userRatingColour').style.color = 'green'
                            //}
                            //else
                            // {
                            //} 

                        //});
                                //    document.getElementById('userRatingColour').style.color = 'blue'

                              //  }
                           //

                       }
                    //});

                </script>


            }





        }
        

 




        <input type="submit" class="btn btn-default" value="Submit">      
        </div>
                
 }